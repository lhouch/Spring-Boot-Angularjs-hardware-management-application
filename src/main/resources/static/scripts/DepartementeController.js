cac.controller('departementecontroller',function($scope,$http,$filter,$rootScope,$routeParams){var page=0;var shrch=false;var url;var idd;var urlp=$rootScope.domainename;$scope.resp=false;$scope.msg=false;$scope.id=-1;$scope.mcsh='';$scope.nav=($routeParams.navr)?true:false;$routeParams.navr=$scope.nav;$scope.navsty=function(){$scope.nav=($scope.nav)?false:true;};function getData(){url=(shrch)?urlp+"chercherDepartement?page="+page+"&mc="+$scope.mcsh:urlp+"departements?page="+page;$http.get(url).success(function(data){$scope.departements=data;if($scope.departements.numberOfElements==0&&$scope.departements.number>0){page=$scope.departements.number-1;getData();}});} $scope.suivente=function(){page=$scope.departements.number+1;getData();};$scope.precedent=function(){page=$scope.departements.number-1;getData();};$scope.sherch=function(){page=0;shrch=true;getData();};$scope.edit=function(ide){departement=filterList(ide);$scope.id=ide;$scope.nom=departement.nom;$scope.description=departement.description;}; $scope.rest=function(){rsetForm();}; function rsetForm(){$scope.nom="";$scope.description="";$scope.resp=false;$scope.msg="";}; $scope.submit=function(){if($scope.id==-1){var data={nom:$scope.nom,description:$scope.description};$http.post(urlp+'departement',JSON.stringify(data)).then(function(response){if(response.data){rsetForm();$scope.resp=true;$scope.msg="Departement "+$scope.nom+" ajouter";getData();}},function(response){$scope.msg="Departement "+$scope.nom+" non ajouter";$scope.resp=false;$scope.statusval=response.status;$scope.statustext=response.statusText;$scope.headers=response.headers();});}else{var data={id:$scope.id,nom:$scope.nom,description:$scope.description};$http.put(urlp+'departement/'+$scope.id,JSON.stringify(data)).then(function(response){if(response.data) getData();$scope.resp=true;$scope.msg="Département Modifier";},function(response){$scope.msg="Error";getData();$scope.resp=false;$scope.statusval=response.status;$scope.statustext=response.statusText;$scope.headers=response.headers();});$scope.id=-1;}};$scope.delet=function(ids){if(ids<0){$http.delete(urlp+"departement/"+idd).then(function(response){getData();},function(response){});}else{type=filterList(ids);$scope.msgsup="Voulez-vous vraiment supprimer Département "+type.nom+", avec tous les personne de ç'est département ?";idd=ids;}};function filterList(ids){return($filter('filter')($scope.departements.content,{id:ids})[0]);} getData();});