cac.controller('typecontroller',function($scope,$http,$filter,$rootScope,$routeParams){var page=0;var shrch=false;var url;var idd;var urlp=$rootScope.domainename;$scope.resp=false;$scope.msg=false;$scope.id=-1;$scope.mcsh='';$scope.nav=($routeParams.navr)?true:false;$routeParams.navr=$scope.nav;$scope.navsty=function(){$scope.nav=($scope.nav)?false:true;};getData();function getData(){url=(shrch)?urlp+"/chercherType?page="+page+"&mc="+$scope.mcsh:urlp+"/types?page="+page;$http.get(url).success(function(data){$scope.types=data;if($scope.types.numberOfElements==0&&$scope.types.number>0){page=$scope.types.number-1;getData();}});}; $scope.suivente=function(){page=$scope.types.number+1;getData();};$scope.precedent=function(){page=$scope.types.number-1;getData();};$scope.sherch=function(){page=0;shrch=true;getData();};$scope.edit=function(ide){type=filterList(ide);$scope.id=ide;$scope.label=type.label;}; $scope.rest=function(){restForm();}; function restForm(){$scope.label="";$scope.resp=false;$scope.msg="";}; $scope.submit=function(){if($scope.id==-1){var data={label:$scope.label};$http.post(urlp+'types',JSON.stringify(data)).then(function(response){if(response.data){getData();$scope.resp=true;$scope.msg="La catégorie "+$scope.label+" ajouter";getData();}},function(response){$scope.msg="La catégorie "+$scope.label+" non ajouter";$scope.resp=false;$scope.statusval=response.status;$scope.statustext=response.statusText;$scope.headers=response.headers();});}else{var data={id:$scope.id,label:$scope.label};$http.put(urlp+'types/'+$scope.id,JSON.stringify(data)).then(function(response){if(response.data){getData();$scope.resp=true;$scope.msg="La Catégorie Modefier";}},function(response){$scope.msg="Error";getData();$scope.resp=false;$scope.statusval=response.status;$scope.statustext=response.statusText;$scope.headers=response.headers();});$scope.id=-1;}};$scope.delet=function(ids){if(ids<0){$http.delete(urlp+"types/"+idd).then(function(response){getData();},function(response){$scope.merror="Désolé impossible de supprimer le type";$('#ErrorModal').modal('show');});}else{type=filterList(ids);$scope.msgsup="Voulez-vous vraiment supprimer la catégorie "+type.label+"?";idd=ids;}};function filterList(ids){return($filter('filter')($scope.types.content,{id:ids})[0]);}});